<!DOCTYPE html>
<html class="no-js" lang="en">
<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>Nuclei Segmentation - Work</title>
    <meta name="description" content="">
    <meta name="author" content="">
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143950329-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-143950329-1');
</script>

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- script
    ================================================== -->
    <script src="js/modernizr.js"></script>

    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">

</head>

<body id="top">

    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader" class="dots-fade">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>


    <!-- header
    ================================================== -->
    <header class="s-header header">

        <div class="header__logo">
            <a class="logo" href="../index.html">
                <p style="font-size: 2em">PK.</p>
            </a>
        </div> <!-- end header__logo -->

        <a class="header__toggle-menu" href="#0" title="Menu"><span>Menu</span></a>
        <nav class="header__nav-wrap">

            <h2 class="header__nav-heading h6">Navigate to</h2>

            <ul class="header__nav">
                <li><a href="../index.html" title="">Home</a></li>
                <li>
                    <a href="../index.html" title="">About</a>
                </li>
                <li>
                    <a href="work.html" title="">Work</a>
                </li>
                <li>
                    <a href="../blog/blog.html" title="">Blog</a>
                </li>
<!--                <li><a href="../services/services.html" title="">Services</a></li>-->
            </ul> <!-- end header__nav -->

            <a href="#0" title="Close Menu" class="header__overlay-close close-mobile-menu">Close</a>

        </nav> <!-- end header__nav-wrap -->

    </header> <!-- s-header -->

    
    
    <!-- s-content
    ================================================== -->
    <section class="s-content s-content--top-padding s-content--narrow">

        <article class="row entry format-standard">

            <div class="entry__media col-full">
                <div class="entry__post-thumb">
                    <img src="images/main_work_image6.gif" 
                         srcset="images/main_work_image6.gif 2000w, 
                                 images/main_work_image6.gif 1000w, 
                                 images/main_work_image6.gif 500w" 
                         sizes="(max-width: 2000px) 500vw, 2000px" alt="">
                </div>
            </div>

            <div class="entry__header col-full">
                <h1 class="entry__header-title display-1">
                    Nuclei Segmentation using Mask-RCNN
                </h1>
                <ul class="entry__header-meta">
                    <li class="date">Jul 11, 2019</li>
                    <li class="byline">
                        By
                        <a href="../index.html">Praveen Kumar</a>
                    </li>
                </ul>
            </div>

            <div class="col-full entry__main">

                <p class="lead drop-cap">Image segmentation is the process of partitioning a digital image into multiple segments (sets of pixels, also known as super-pixels). The goal of segmentation is to simplify and/or change the representation of an image into something that is more meaningful and easier to analyze. Image segmentation is typically used to locate objects and boundaries (lines, curves, etc ) in images. More precisely, image segmentation is the process of assigning a label to every pixel in an image such that pixels with the same label share certain characteristics.</p>
                
                <p>The typical use of convolutional networks is on classification tasks, where the output to an image is a single class label. However, in many visual tasks, especially in biomedical image processing, the desired output should include localization, i.e., a class label is supposed to be assigned to each pixel.</p>

                <blockquote><p>Reference to implementation: <a href="https://github.com/inboxpraveen/Nuclei-Segmentation-using-Mask-RCNN" target="_blank">Check on GitHub</a></p></blockquote>
                
                <p>
                <img src="images/segmentation.jpg" srcset="images/segmentation.jpg 2000w, images/segmentation.jpg 1000w, images/segmentation.jpg 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Segmentation Image">
                </p>


                <h2>About dataset</h2>

                <p>We are given <a href="https://www.kaggle.com/c/data-science-bowl-2018" target="_blank">Nuclei Segmentation dataset</a> which consists of training and test zip files for training images and test images respectively. Inside training images, we have 2 folders for different types of nuclei classes. One folder is for the original training image, and second is the masks images of the training image. Inside test folder, we simply have the image and our target is to mask or segment all the nuclei using Average mean prediction matrices.</p>


                <p>Sample Training Images</p>
                <p>
                <img src="images/train_images_samples.jpg" srcset="images/train_images_samples.jpg 2000w, images/train_images_samples.jpg 1000w, images/train_images_samples.jpg 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Training Image">
                </p>
                <p>Sample Test Images</p>
                <p>
                <img src="images/test_images_samples.jpg" srcset="images/test_images_samples.jpg 2000w, images/test_images_samples.jpg 1000w, images/test_images_samples.jpg 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Segmentation Image">
                </p>

                <h2>Approch</h2>

                <p>Such biomedical images require very precise training since nuclei size in an image might even vary from 100x100 pixel to 1x1 pixel. Detection and segmenting such low resolution nuclei is very important and also difficult. One very famous architecture used of segmenting nuclei is <a href="https://arxiv.org/pdf/1505.04597.pdf" target="_blank">U-Net: Convolutional Networks for Biomedical Image Segmentation presented by Olaf Ronneberger, Philipp Fischer, and Thomas Brox</a>.

<!--
<pre><code>
    code {
        font-size: 1.4rem;
        margin: 0 .2rem;
        padding: .2rem .6rem;
        white-space: nowrap;
        background: #F1F1F1;
        border: 1px solid #E1E1E1;
        border-radius: 3px;
    }
</code></pre>
-->

                <img src="images/unet.png" srcset="images/unet.png 2000w, images/unet.png 1000w, images/unet.png 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Unet Image">
                </p>
                
                <p>It consists of a contracting path (left side) and an expansive path (right side). The contracting path follows the typical architecture of a convolutional network. It consists of the repeated application of two 3x3 convolutions (unpadded convolutions), each followed by a rectified linear unit (ReLU) and a 2x2 max pooling operation with stride 2 for downsampling. At each downsampling step we double the number of feature channels. Every step in the expansive path consists of an upsampling of the feature map followed by a 2x2 convolution (“up-convolution”) that halves the number of feature channels, a concatenation with the correspondingly cropped feature map from the contracting path, and two 3x3 convolutions, each followed by a ReLU. The cropping is necessary due to the loss of border pixels in every convolution. At the final layer a 1x1 convolution is used to map each 64 component feature vector to the desired number of classes. In total the network has 23 convolutional layers.<a href="https://arxiv.org/pdf/1505.04597.pdf" target="_blank">Reference paper</a>.<br><br>The initial approach was made using the default architecture, which had 31,032,837 trainable parameters. <br><br>When trained for 15 epochs, the network resulted in constant IOU. Hence, we were not able to apply the UNet default architecture directly for our problem statement. During prediction, we keep a threshold value of prediction, over which all the images are segmented based on their mean IOU. The threshold value is 0.5. When predictions were made from the default architecture, it resulted in a dark image without any segmentation since mean IOU was not greater than 0.5, can also seen in the following prediction image</p>
                <img src="images/prediction_mapping_model1.jpg" srcset="images/prediction_mapping_model1.jpg 2000w, images/prediction_mapping_model1.jpg 1000w, images/prediction_mapping_model1.jpg 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Unet Image">
                </p>

                <ul>
                    <h4>Inferences made from default U-Net and definition of updated architecture</h4>
                    <li>Inference 1: Relu was eliminating all the True Negatives completely and our network was no longer able to learn further. Hence we our network never improved after a certain point.
                    </li>
                    <li>Inference 2: Mean_IOU is not increasing by using default U-Net architecture, but surely we see that validation loss has constantly decreased. We needed to tweak the architecture.</li>
                    <li>Inference 3: All the input images are pretty flat and un-normalized. This could be one of the reasons as well since the mask over the images are normalized, the values of gradients is not able to identify most loudly screaming features after masking.</li>
                </ul>
                
                <ul>
                    <h4>Transition to updated Architecture</h4>
                    <li>We added the drop-outs after every convolution layer since the accuracy gaps in the default architecture was huge. So to avoid overfitting and large accuracy gaps, we adding small dropouts with 0.1 as rate.
                    </li>
                    <li>All the images during input are scaled by dividing each input image by 255. This helps in normalizing all the pixel to a normally distributed value range.</li>
                    <li>Instead of using Relu, we use elu so as to provide exponentially smaller value but not 0.</li>
                    <li>Reduced the number of parameters since total number of parameters in default architecture are very high. By following this approach, we reduced the number of parameters to 1,941,105.</li>
                </ul>
                    
            
                <p>Using the above architecture, we obtained Mean_IOU score of 86%, which is double to that of default architecture. <br>This network did fantastic job during predictions, which can also be concluded by the following image.</p>
                <img src="images/prediction_mapping_model2.jpg" srcset="images/prediction_mapping_model2.jpg 2000w, images/prediction_mapping_model2.jpg 1000w, images/prediction_mapping_model2.jpg 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Unet Image">
            
            <h3>Image Augmentation (Worth a try)</h3>
            <p>We also tried to Image augmentations strategies mentioned in the U-Net Paper. We used normal rotation, width &amp; height shifting, shear deformations, flips and zoom ranges. However, they did not work out on the trained model and decreased mean_IOU score. So we did not move ahead. Do not consider this approach during evaluation.</p>
            
            <h2>Final Predictions on Validation set</h2>
            
                <img src="images/predictions_on_validation_set.png" srcset="images/predictions_on_validation_set.png 2000w, images/predictions_on_validation_set.png 1000w, images/predictions_on_validation_set.png 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Unet Image">

            <h2>Prediction on Test Images and &amp; sample prediction output</h2>
                <img src="images/Predicting_on_random_Test_image.jpg" srcset="images/Predicting_on_random_Test_image.jpg 2000w, images/Predicting_on_random_Test_image.jpg 1000w, images/Predicting_on_random_Test_image.jpg 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Unet Image">
                <img src="images/Prediction_result_on_random_Test_image.jpg" srcset="images/Prediction_result_on_random_Test_image.jpg 2000w, images/Prediction_result_on_random_Test_image.jpg 1000w, images/Prediction_result_on_random_Test_image.jpg 500w" sizes="(max-width: 2000px) 500vw, 2000px" alt="Unet Image">
            
                <blockquote><p>Reference to implementation: <a href="https://github.com/inboxpraveen/Nuclei-Segmentation-using-Mask-RCNN" target="_blank">Check on GitHub</a></p></blockquote>
                <div class="entry__author">
                    <img src="../images/main_pic2.jpeg" alt="">

                    <div class="entry__author-about">
                        <h5 class="entry__author-name">
                            <span>by</span>
                            <a href="../index.html">Praveen Kumar</a>
                        </h5>

                        <div class="entry__author-desc">
                            <p>
                            Machine Learning Engineer &amp; Developer. Follow him on <a href="https://linkedin.com/in/praveen-kumar-inbox" target="_blank">LINKEDIN</a> Or <a href="https://github.com/inboxpraveen" target="_blank">GITHUB</a>
                            </p>
                        </div>
                    </div>
                </div>

<!--            </div>  s-entry__main -->

        </article> <!-- end entry/article -->


        <div class="s-content__entry-nav" style="background: lightblue">
            <div class="row s-content__nav">
                <div class="col-six s-content__prev">
                    <a href="../coming_soon/index.html" rel="prev">
                        <span>Previous Work</span>
                        FIFA 19 Player Recommender System 
                    </a>
                </div>
                <div class="col-six s-content__next">
                    <a href="lesion.html" rel="next">
                        <span>Next Work</span>
                        Skin Cancer Lesion Detection
                    </a>
                </div>
            </div>
        </div> <!-- end s-content__pagenav -->

    </section> <!-- end s-content -->



    <!-- s-extra
    ================================================== -->
    <section class="s-extra">

        <div class="row">

            <div class="col-nine md-six tab-full popular">
                <h3>Recent Posts &amp; Works</h3>

                <div class="block-1-1 block-m-full popular__posts">
                    
                    <article class="col-block popular__post">
                        <a href="https://medium.com/hitchhikers-guide-to-deep-learning/5-introduction-to-deep-learning-with-computer-vision-kernels-channels-neural-architecture-41b6bc4befa7?source=friends_link&sk=7a8b74d1ddd91fdbc6e5613fee3a0d4a" target="_blank" class="popular__thumb">
                            <img src="../blog/images/partsofobject.jpg" alt="">
                        </a>
                        <h5><a href="https://medium.com/hitchhikers-guide-to-deep-learning/5-introduction-to-deep-learning-with-computer-vision-kernels-channels-neural-architecture-41b6bc4befa7?source=friends_link&sk=7a8b74d1ddd91fdbc6e5613fee3a0d4a" target="_blank">[BLOG] 5. Introduction to Deep Learning with Computer Vision - Kernels, Channels &amp; Nueral Architecture</a></h5>
                        <section class="popular__meta">
                            <span class="popular__author"><span>By</span> <a href="../index.html">Praveen Kumar</a></span>
                            <span class="popular__date"><span>on</span> <time datetime="2019-07-20">Jul 20, 2019</time></span>
                        </section>
                    </article>
                    
                    <article class="col-block popular__post">
                        <a href="../coming_soon/index.html" class="popular__thumb">
                            <img src="images/main_work_image2.gif" alt="">
                        </a>
                        <h5><a href="../coming_soon/index.html">[WORK] Some work links</a></h5>
                        <section class="popular__meta">
                            <span class="popular__author"><span>By</span> <a href="../index.html">Praveen Kumar</a></span>
                            <span class="popular__date"><span>on</span> <time datetime="2019-07-15">Jul , 2019</time></span>
                        </section>
                    </article>
                    
                    <article class="col-block popular__post">
                        <a href="https://medium.com/hitchhikers-guide-to-deep-learning/4-introduction-to-computer-vision-with-deep-learning-datasets-and-dl-libraries-7000cc858200?source=friends_link&sk=69d26143611ba308c399860b90b02010" target="_blank" class="popular__thumb">
                            <img src="../blog/images/tony_start_arc.jpg" alt="">
                        </a>
                        <h5><a href="https://medium.com/hitchhikers-guide-to-deep-learning/4-introduction-to-computer-vision-with-deep-learning-datasets-and-dl-libraries-7000cc858200?source=friends_link&sk=69d26143611ba308c399860b90b02010" target="_blank">[BLOG] 4. Introduction to Computer Vision with Deep Learning: Datasets and DL libraries</a></h5>
                        <section class="popular__meta">
                            <span class="popular__author"><span>By</span> <a href="../index.html">Praveen Kumar</a></span>
                            <span class="popular__date"><span>on</span> <time datetime="2019-07-15">Jul , 2019</time></span>
                        </section>
                    </article>
                    
                    <article class="col-block popular__post">
                        <a href="../coming_soon/index.html" class="popular__thumb">
                            <img src="images/main_work_image2.gif" alt="">
                        </a>
                        <h5><a href="../coming_soon/index.html">[WORK] Some work links</a></h5>
                        <section class="popular__meta">
                            <span class="popular__author"><span>By</span> <a href="../index.html">Praveen Kumar</a></span>
                            <span class="popular__date"><span>on</span> <time datetime="2019-07-15">Jul 15, 2019</time></span>
                        </section>
                    </article>
                    
                </div> <!-- end popular_posts -->
            </div> <!-- end popular -->

        </div> <!-- end row -->

    </section> <!-- end s-extra -->


    <!-- s-footer
    ================================================== -->
    <footer class="s-footer">
        

        <div class="s-footer__main">
        
            
            <div class="row">
                
            <div class="s-footer__bottom" style="margin-bottom: 3em">
            <div class="row">

                <div class="col-twelve" style="text-align: center">
                    <ul class="footer-social">
                        <li>
                            <a href="https://github.com/inboxpraveen" target="_blank"><i class="fab fa-github"></i></a>
                        </li>
                        <li>
                            <a href="https://linkedin.com/in/praveen-kumar-inbox" target="_blank"><i class="fab fa-linkedin"></i></a>
                        </li>
                    </ul>
                </div>
                
            </div>
        </div> <!-- end s-footer__bottom -->
                
                <div class="col-twelve tab-full s-footer__about">
                        
                    <h4>About</h4>

                    <p><strong>Hi I'm Praveen Kumar</strong>, Final year undergrad pursuing engineering from MVJ College of Engineer in Computer Science. I am a enthusiast learner. I intent to work, apply, &amp; enhance my skills and keep learning at every step of my career. My knowledge in machine learning comes from self learning for over 8 to 10 months and deep learning from Inkers.inc. I have been working as a intern at EIP 3.0 for 7 months now and also part of School Of AI, MLBLR in Extensive Vision AI program.</p>
					<p> I aim to make a difference through my creative solutions.</p>

                </div> <!-- end s-footer__about -->

<!--
                <div class="col-six tab-full s-footer__subscribe">
                        
                    <h1 style="text-align: center; color: white">Looking for challenge? Waiting to start? </h1>
                    <p style="color: white; text-align: center">Interested to learn, develop and deploy? Let's work together to make the world a better place.</p>
                    
                    <a href="../services/services.html"><h1 class="col-twelve tab-full" style="text-align: center; color: white; border-bottom: 0.1em solid; border-radius: 100%;">JOIN US!</h1></a>

                </div>  end s-footer__subscribe 
-->

            </div>
        </div> <!-- end s-footer__main -->

        <div class="go-top">
            <a class="smoothscroll" title="Back to Top" href="#top"></a>
        </div>

    </footer> <!-- end s-footer -->


    <!-- Java Script
    ================================================== -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>

</body>

</html>